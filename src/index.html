<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <title>MyRecord</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="stylesheet" href="./amis/sdk.css" />
    <link rel="stylesheet" href="./amis/helper.css" />
    <link rel="stylesheet" href="./amis/iconfont.css" />
    <script src="./js/ajaxhook-3.0.3.min.js"></script>
    <script src="./script/util.js"></script>
    <script src="./script/mockData.js"></script>
    <script src="./script/mock.js"></script>
    <!-- 这是默认主题所需的，如果是其他主题则不需要 -->
    <!-- 从 1.1.0 开始 sdk.css 将不支持 IE 11，如果要支持 IE11 请引用这个 css，并把前面那个删了 -->
    <!-- <link rel="stylesheet" href="sdk-ie11.css" /> -->
    <!-- 不过 amis 开发团队几乎没测试过 IE 11 下的效果，所以可能有细节功能用不了，如果发现请报 issue -->
    <style>
        html,
        body,
        .app-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <a href="test3.html"> node </a> </br>
    <div id="root" class="app-wrapper"></div>
    <script src="./amis/sdk.js"></script>
    <script type="text/javascript">
        (function () {
            let amis = amisRequire('amis/embed');
            // 通过替换下面这个配置来生成不同页面
            let amisJSON = {
                type: 'page',
                title: '表单页面',
                body: [
                    {
                        "type": "page",
                        "title": "",
                        "body": [
                            {
                                "type": "crud",
                                "syncLocation": false,
                                "api": {
                                    "method": "post",
                                    "url": "/record",
                                    "requestAdaptor": (r, c) => {
                                        console.log(r);
                                        console.log(c);
                                        ct = undefined
                                        if (c.create_time != undefined) {
                                            des = c.create_time.split(",")
                                            ct = {
                                                start_time: new Date(des[0] * 1000),
                                                end_time: new Date(des[1] * 1000)
                                            }
                                        }
                                        ut = undefined
                                        if (c.update_time != undefined) {
                                            des = c.create_time.split(",")
                                            ut = {
                                                start_time: new Date(des[0] * 1000),
                                                end_time: new Date(des[1] * 1000)
                                            }
                                        }
                                        return {
                                            ...r,
                                            data: {
                                                ...r.data,
                                                "per_page": c.perPage,
                                                "id": c.id,
                                                "content": c.content,
                                                "quotes": c.quotes ? c.quotes.split(",") : c.quotes,
                                                "referenceds": c.referenceds ? c.referenceds.split(",") : c.referenceds,
                                                "labels": c.labels ? c.labels.split(",") : c.labels,
                                                "create_time": ct,
                                                "update_time": ut,
                                            }
                                        };
                                    }
                                },
                                // "autoGenerateFilter": {
                                //     "columnsNum": 2,
                                //     "showBtnToolbar": false
                                // },
                                "columns": [
                                    {
                                        "name": "id",
                                        "label": "ID",
                                        "type": "text",
                                        "searchable": true,
                                        "id": "u:292727c6920a"
                                    },
                                    {
                                        "name": "content",
                                        "label": "内容",
                                        "type": "text",
                                        "searchable": true,
                                        "id": "u:cef0b36e020b"
                                    },
                                    {
                                        "type": "text",
                                        "name": "labels",
                                        "label": "标签组",
                                        "searchable": {
                                            "type": "input-tag",
                                            "label": "标签组",
                                            "placeholder": "请选择标签",
                                            "options": [
                                                "Aaron Rodgers",
                                                "Tom Brady",
                                                "Charlse Woodson",
                                                "Aaron Jones"
                                            ]
                                        },
                                        "id": "u:cf20988feb18"
                                    },
                                    {
                                        "type": "text",
                                        "name": "quotes",
                                        "label": "引用情况",
                                        "searchable": {
                                            "type": "input-tag",
                                            "label": "引用",
                                            "placeholder": "请选择引用",
                                            "options": [
                                                "Aaron Rodgers",
                                                "Tom Brady",
                                                "Charlse Woodson",
                                                "Aaron Jones"
                                            ]
                                        },
                                        "id": "u:18d01b7aee38"
                                    },
                                    {
                                        "type": "text",
                                        "label": "被引用情况",
                                        "name": "referenceds",
                                        "searchable": {
                                            "type": "input-tag",
                                            "label": "引用",
                                            "placeholder": "请选择引用",
                                            "options": [
                                                "Aaron Rodgers",
                                                "Tom Brady",
                                                "Charlse Woodson",
                                                "Aaron Jones"
                                            ]
                                        },
                                        "id": "u:d61bb65cff32"
                                    },
                                    {
                                        "type": "date",
                                        "label": "创建时间",
                                        "name": "create_time",
                                        "searchable": {
                                            "type": "input-date-range",
                                            "label": "创建时间范围"
                                        },
                                        "id": "u:1dce08bd6b78"
                                    },
                                    {
                                        "type": "date",
                                        "label": "修改时间",
                                        "name": "update_time",
                                        "searchable": true,
                                        "id": "u:ae3325cdede3"
                                    },
                                    {
                                        "type": "operation",
                                        "label": "操作",
                                        "buttons": [
                                            {
                                                "label": "编辑",
                                                "type": "button",
                                                "actionType": "dialog",
                                                "level": "link",
                                                "editorSetting": {
                                                    "behavior": "update"
                                                },
                                                "dialog": {
                                                    "title": "编辑",
                                                    "body": {
                                                        "type": "form",
                                                        "api": "xxx/update",
                                                        "body": [
                                                            {
                                                                "name": "id",
                                                                "label": "ID",
                                                                "type": "input-text"
                                                            },
                                                            {
                                                                "name": "content",
                                                                "label": "内容",
                                                                "type": "input-text"
                                                            },
                                                            {
                                                                "name": "labels",
                                                                "label": "标签组",
                                                                "type": "input-text"
                                                            },
                                                            {
                                                                "name": "quotes",
                                                                "label": "引用情况",
                                                                "type": "input-text"
                                                            },
                                                            {
                                                                "label": "被引用情况",
                                                                "name": "referenceds",
                                                                "type": "input-text"
                                                            },
                                                            {
                                                                "label": "创建时间",
                                                                "name": "create_time",
                                                                "type": "input-date"
                                                            },
                                                            {
                                                                "label": "修改时间",
                                                                "name": "update_time",
                                                                "type": "input-date"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "id": "u:416549b859dc"
                                            },
                                            {
                                                "label": "查看",
                                                "type": "button",
                                                "actionType": "dialog",
                                                "level": "link",
                                                "editorSetting": {
                                                    "behavior": "view"
                                                },
                                                "dialog": {
                                                    "title": "查看详情",
                                                    "body": {
                                                        "type": "form",
                                                        "api": "xxx/update",
                                                        "body": [
                                                            {
                                                                "name": "id",
                                                                "label": "ID",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "name": "content",
                                                                "label": "内容",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "name": "labels",
                                                                "label": "标签组",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "name": "quotes",
                                                                "label": "引用情况",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "label": "被引用情况",
                                                                "name": "referenceds",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "label": "创建时间",
                                                                "name": "create_time",
                                                                "type": "static"
                                                            },
                                                            {
                                                                "label": "修改时间",
                                                                "name": "update_time",
                                                                "type": "static"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "id": "u:f4d99186dfa1"
                                            },
                                            {
                                                "type": "button",
                                                "label": "删除",
                                                "actionType": "ajax",
                                                "level": "link",
                                                "className": "text-danger",
                                                "confirmText": "确定要删除？",
                                                "api": {
                                                    "method": "post",
                                                    "url": "/record"
                                                },
                                                "editorSetting": {
                                                    "behavior": "delete"
                                                },
                                                "id": "u:af994b320404"
                                            }
                                        ],
                                        "id": "u:7ae5ec1ec8ff"
                                    }
                                ],
                                "bulkActions": [
                                    {
                                        "type": "button",
                                        "level": "danger",
                                        "label": "批量删除",
                                        "actionType": "ajax",
                                        "confirmText": "确定要删除？",
                                        "api": "/xxx/batch-delete",
                                        "editorSetting": {
                                            "behavior": "bulkDelete"
                                        },
                                        "id": "u:85a62cf0ced7"
                                    }
                                ],
                                "itemActions": [],
                                "headerToolbar": [
                                    {
                                        "label": "新增",
                                        "type": "button",
                                        "actionType": "dialog",
                                        "level": "primary",
                                        "editorSetting": {
                                            "behavior": "create"
                                        },
                                        "dialog": {
                                            "title": "新增",
                                            "body": {
                                                "type": "form",
                                                "api": {
                                                    "method": "post",
                                                    "url": "/record"
                                                },
                                                "body": [
                                                    {
                                                        "type": "input-text",
                                                        "name": "id",
                                                        "label": "ID"
                                                    },
                                                    {
                                                        "type": "input-text",
                                                        "name": "content",
                                                        "label": "内容"
                                                    },
                                                    {
                                                        "type": "input-text",
                                                        "name": "labels",
                                                        "label": "标签组"
                                                    },
                                                    {
                                                        "type": "input-text",
                                                        "name": "quotes",
                                                        "label": "引用情况"
                                                    },
                                                    {
                                                        "type": "input-text",
                                                        "name": "referenceds",
                                                        "label": "被引用情况"
                                                    },
                                                    {
                                                        "type": "input-date",
                                                        "name": "create_time",
                                                        "label": "创建时间"
                                                    },
                                                    {
                                                        "type": "input-date",
                                                        "name": "update_time",
                                                        "label": "修改时间"
                                                    }
                                                ]
                                            }
                                        },
                                        "id": "u:54f7b9bb5dff"
                                    },
                                    "bulkActions"
                                ],
                                "id": "u:409cc08662cd"
                            }
                        ],
                        "id": "u:63683c3d3018",
                        "asideResizor": false,
                        "pullRefresh": {
                            "disabled": true
                        },
                        "aside": [],
                        "toolbar": [],
                        "regions": [
                            "body"
                        ]
                    },
                    // {
                    //     type: 'form',
                    //     mode: 'horizontal',
                    //     api: '/saveFormerr?cc=sdfdsf',
                    //     body: [
                    //         {
                    //             label: 'Name',
                    //             type: 'input-text',
                    //             name: 'name'
                    //         },
                    //         {
                    //             label: 'Email',
                    //             type: 'input-text',
                    //             name: 'email'
                    //         }
                    //     ]
                    // },
                    // {
                    //     "type": "page",
                    //     "body": {
                    //         "type": "chart",
                    //         "api": "/amis/api/mock2/chart/chartData",
                    //         "config": {
                    //             tooltip: {},
                    //             legend: [
                    //                 {
                    //                     data: "${ARRAYMAP(categories, item => item.name)}"
                    //                 }
                    //             ],
                    //             series: [
                    //                 {
                    //                     name: 'Les Miserables',
                    //                     type: 'graph',
                    //                     layout: 'none',
                    //                     data: "${nodes}",
                    //                     links: "${links}",
                    //                     categories: "${categories}",
                    //                     roam: true,
                    //                     label: {
                    //                         show: true,
                    //                         position: 'right',
                    //                         formatter: '{b}',
                    //                         color: "inherit"
                    //                     },
                    //                     labelLayout: {
                    //                         hideOverlap: true
                    //                     },
                    //                     scaleLimit: {
                    //                         min: 0.4,
                    //                         max: 2
                    //                     },
                    //                     lineStyle: {
                    //                         color: 'source',
                    //                         curveness: 0.3
                    //                     },
                    //                 }
                    //             ]
                    //         }
                    //     }
                    // }
                ]
            };
            let amisScoped = amis.embed('#root', amisJSON);
        })();
    </script>
</body>

</html>